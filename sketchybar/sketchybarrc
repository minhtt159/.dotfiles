#!/usr/bin/env sh

# SketchyBar configuration using SbarLua
# This replaces the original shell-based configuration with a Lua-based one
# for better performance and more flexible event handling.

# The original shell configuration is preserved as sketchybarrc.sh for reference

# Check if SbarLua is installed
if [ ! -f "$HOME/.local/share/sketchybar_lua/sketchybar.so" ]; then
  echo "SbarLua module not found. Installing..."
  echo "Please run the following command to install SbarLua:"
  echo "(git clone https://github.com/FelixKratz/SbarLua.git /tmp/SbarLua && cd /tmp/SbarLua/ && make install && rm -rf /tmp/SbarLua/)"
  echo ""
  echo "Falling back to original shell configuration..."
  exec "$HOME/.config/sketchybar/sketchybarrc.sh"
  exit 1
fi

# Run the Lua configuration
lua "$HOME/.config/sketchybar/init.lua"
